<Window x:Class="CrxMem.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
        xmlns:wfi="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
        Title="CrxMem"
        Width="850" Height="680"
        MinWidth="700" MinHeight="500"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/Colors.xaml"/>
                <ResourceDictionary Source="Themes/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <!-- Main Container with Shadow -->
    <Border Background="{StaticResource BackgroundDarkBrush}" 
            CornerRadius="8" 
            Margin="8"
            BorderBrush="{StaticResource BorderDefaultBrush}"
            BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect BlurRadius="15" ShadowDepth="0" Opacity="0.4" Color="Black"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>      <!-- Custom Title Bar -->
                <RowDefinition Height="Auto"/>    <!-- Menu Bar -->
                <RowDefinition Height="Auto"/>    <!-- Toolbar -->
                <RowDefinition Height="Auto"/>    <!-- Progress Bar -->
                <RowDefinition Height="*"/>       <!-- Main Content -->
                <RowDefinition Height="Auto"/>    <!-- Status Bar -->
            </Grid.RowDefinitions>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- CUSTOM TITLE BAR (includes process name) -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="0" 
                    Background="{StaticResource BackgroundCardBrush}"
                    CornerRadius="8,8,0,0">
                <Grid MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Logo & Title -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="10,0">
                        <Image x:Name="imgLogo" Width="16" Height="16" Margin="0,0,6,0"/>
                        <TextBlock x:Name="txtWindowTitle" 
                                   Text="CrxMem v1.1" 
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   VerticalAlignment="Center"
                                   FontWeight="SemiBold"
                                   FontSize="12"/>
                    </StackPanel>
                    
                    <!-- Separator -->
                    <TextBlock Grid.Column="1" Text="â€”" 
                               Foreground="{StaticResource TextMutedBrush}"
                               VerticalAlignment="Center"
                               Margin="6,0"/>
                    
                    <!-- Process Name (informational, not clickable) -->
                    <TextBlock x:Name="txtProcessName" Grid.Column="2"
                               Text="No Process Selected"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="11"
                               VerticalAlignment="Center"/>
                    
                    <!-- Window Controls -->
                    <StackPanel Grid.Column="3" Orientation="Horizontal">
                        <Button Content="â”€" Click="Minimize_Click" 
                                Style="{StaticResource IconButtonStyle}"
                                Width="40" Height="32" FontSize="12"/>
                        <Button x:Name="btnMaximize" Content="â–¡" Click="Maximize_Click" 
                                Style="{StaticResource IconButtonStyle}"
                                Width="40" Height="32" FontSize="10"/>
                        <Button x:Name="btnClose" Content="âœ•" Click="Close_Click" 
                                Style="{StaticResource IconButtonStyle}"
                                Width="40" Height="32" FontSize="10"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- MENU BAR -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Menu Grid.Row="1"
                  Background="{StaticResource BackgroundCardBrush}"
                  Foreground="{StaticResource TextPrimaryBrush}"
                  Padding="6,2">
                <Menu.Resources>
                    <!-- Override the IconBar background color that causes white lines -->
                    <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="#1F2937"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.ControlLightBrushKey}" Color="#1F2937"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.ControlLightLightBrushKey}" Color="#1F2937"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.MenuBarBrushKey}" Color="#1F2937"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.MenuBrushKey}" Color="#1F2937"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.MenuHighlightBrushKey}" Color="#374151"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.MenuTextBrushKey}" Color="#E6EDF3"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#374151"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="#FFFFFF"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.WindowBrushKey}" Color="#1F2937"/>

                    <!-- Custom ItemsPanel template to remove the icon gutter -->
                    <ItemsPanelTemplate x:Key="MenuItemsPanelTemplate">
                        <StackPanel Background="#1F2937"/>
                    </ItemsPanelTemplate>

                    <!-- MenuItem style with light text color -->
                    <Style TargetType="MenuItem">
                        <Setter Property="Background" Value="#1F2937"/>
                        <Setter Property="Foreground" Value="#E6EDF3"/>
                        <Setter Property="BorderBrush" Value="Transparent"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Padding" Value="8,4"/>
                        <Style.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" Value="#374151"/>
                                <Setter Property="Foreground" Value="#FFFFFF"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>

                    <!-- Full Separator template to eliminate white line -->
                    <Style TargetType="Separator">
                        <Setter Property="Height" Value="1"/>
                        <Setter Property="Margin" Value="4,4"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Separator">
                                    <Border Height="1" Background="#374151" Margin="0"/>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Menu.Resources>
                <MenuItem Header="_File">
                    <MenuItem Header="_Open Process" Click="OpenProcess_Click"/>
                    <Separator/>
                    <MenuItem Header="_Save Table" Click="SaveTable_Click" InputGestureText="Ctrl+S"/>
                    <MenuItem Header="_Load Table" Click="LoadTable_Click" InputGestureText="Ctrl+O"/>
                    <Separator/>
                    <MenuItem Header="E_xit" Click="Exit_Click"/>
                </MenuItem>
                <MenuItem Header="_Edit">
                    <MenuItem x:Name="menuLiveUpdates" Header="_Live Updates"
                              IsCheckable="True" IsChecked="True"
                              Click="LiveUpdates_Click"/>
                </MenuItem>
                <MenuItem Header="_Tools">
                    <MenuItem Header="_Lua Engine (WPF)" Click="LuaEngineWpf_Click" InputGestureText="Ctrl+L"/>
                    <MenuItem Header="Lua Engine (_Legacy WinForms)" Click="LuaEngine_Click"/>
                    <Separator/>
                    <MenuItem Header="L_UA Monitor" Click="LuaMonitor_Click"/>
                    <MenuItem Header="_PE Analysis" Click="PEAnalysis_Click"/>
                    <MenuItem Header="_AC Bypass Lab" Click="ACBypassLab_Click"/>
                    <MenuItem Header="_DLL Injection Test" Click="DllInjectionTest_Click"/>
                </MenuItem>
                <MenuItem Header="_Settings" Click="Settings_Click"/>
                <MenuItem Header="_Help">
                    <MenuItem Header="_About" Click="About_Click"/>
                </MenuItem>
            </Menu>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- TOOLBAR -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="2" 
                    Background="{StaticResource BackgroundCardBrush}"
                    Padding="6,3"
                    BorderBrush="{StaticResource BorderMutedBrush}"
                    BorderThickness="0,0,0,1">
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="btnOpenProcess" Click="OpenProcess_Click"
                            ToolTip="Open Process"
                            Style="{StaticResource IconButtonStyle}"
                            Margin="0,0,2,0">
                        <TextBlock Text="ðŸ“‚" FontSize="14"/>
                    </Button>
                    <Button x:Name="btnLoadTable" Click="LoadTable_Click"
                            ToolTip="Load Table (Ctrl+O)"
                            Style="{StaticResource IconButtonStyle}"
                            Margin="0,0,2,0">
                        <TextBlock Text="ðŸ“„" FontSize="14"/>
                    </Button>
                    <Button x:Name="btnSaveTable" Click="SaveTable_Click"
                            ToolTip="Save Table (Ctrl+S)"
                            Style="{StaticResource IconButtonStyle}">
                        <TextBlock Text="ðŸ’¾" FontSize="14"/>
                    </Button>
                </StackPanel>
            </Border>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- PROGRESS BAR -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <ProgressBar x:Name="progressBar" Grid.Row="3"
                         Style="{StaticResource ModernProgressBarStyle}"
                         Visibility="Collapsed"
                         Height="3"/>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- MAIN CONTENT AREA -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid Grid.Row="4" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="150"/>
                    <RowDefinition Height="6"/>
                    <RowDefinition Height="150" MinHeight="80"/>
                </Grid.RowDefinitions>
                
                <!-- TOP SECTION: Scan Results + Controls -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" MinWidth="180"/>
                        <ColumnDefinition Width="8"/>
                        <ColumnDefinition Width="300"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- SCAN RESULTS PANEL -->
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Header -->
                            <Grid Grid.Row="0">
                                <TextBlock Style="{StaticResource SectionHeaderStyle}"
                                           Text="SCAN RESULTS"/>
                                <TextBlock x:Name="txtFoundCount" 
                                           Text="Found: 0"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           FontSize="10"
                                           HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <!-- Results ListView (WPF Native) -->
                            <Border Grid.Row="1"
                                    BorderBrush="{StaticResource BorderDefaultBrush}"
                                    BorderThickness="1"
                                    CornerRadius="4"
                                    Margin="0,4,0,0">
                                <ListView x:Name="lvFoundAddressesWpf"
                                          Background="#161B22"
                                          Foreground="#E6EDF3"
                                          BorderThickness="0"
                                          SelectionMode="Extended"
                                          MouseDoubleClick="LvFoundAddresses_DoubleClick">
                                    <ListView.Resources>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="#E6EDF3"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#2D3748"/>
                                                    <Setter Property="Foreground" Value="#FFFFFF"/>
                                                </Trigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#1F2937"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListView.Resources>
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="Address" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Address}"
                                                                 Foreground="{Binding Foreground}"
                                                                 FontFamily="Cascadia Code" FontSize="12"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Value" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Value}"
                                                                 FontFamily="Cascadia Code" FontSize="12"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Previous" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Previous}"
                                                                 FontFamily="Cascadia Code" FontSize="12"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                    <ListView.ContextMenu>
                                        <ContextMenu Background="#1F2937" Foreground="#E6EDF3">
                                            <ContextMenu.Resources>
                                                <Style TargetType="MenuItem">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="Foreground" Value="#E6EDF3"/>
                                                    <Setter Property="BorderThickness" Value="0"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsHighlighted" Value="True">
                                                            <Setter Property="Background" Value="#374151"/>
                                                            <Setter Property="Foreground" Value="#FFFFFF"/>
                                                            <Setter Property="BorderBrush" Value="Transparent"/>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled" Value="False">
                                                            <Setter Property="Foreground" Value="#6B7280"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                                <Style TargetType="Separator">
                                                    <Setter Property="Background" Value="#374151"/>
                                                    <Setter Property="Margin" Value="0,2"/>
                                                </Style>
                                            </ContextMenu.Resources>
                                            <MenuItem Header="Copy Address" Click="CopyFoundAddress_Click"/>
                                            <MenuItem Header="Browse this memory region" Click="BrowseMemoryRegion_Click"/>
                                        </ContextMenu>
                                    </ListView.ContextMenu>
                                </ListView>
                            </Border>
                            
                            <!-- Footer Buttons -->
                            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,6,0,0">
                                <Button Content="ðŸ” Memory View" Click="MemoryView_Click"
                                        Style="{StaticResource ModernButtonStyle}"
                                        Margin="0,0,4,0"/>
                                <Button x:Name="btnAddToList" Content="â†“ Add to List"
                                        Click="AddToList_Click"
                                        Style="{StaticResource ModernButtonStyle}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- SCAN CONTROLS PANEL -->
                    <Border Grid.Column="2" Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <!-- Scan Buttons -->
                            <WrapPanel Margin="0,0,0,6">
                                <Button x:Name="btnFirstScan" Content="First Scan" 
                                        Click="FirstScan_Click"
                                        Style="{StaticResource ModernButtonStyle}"
                                        IsEnabled="False"
                                        Margin="0,0,4,4"/>
                                <Button x:Name="btnNextScan" Content="Next Scan" 
                                        Click="NextScan_Click"
                                        Style="{StaticResource ModernButtonStyle}"
                                        IsEnabled="False"
                                        Margin="0,0,4,4"/>
                                <Button x:Name="btnNewScan" Content="New Scan" 
                                        Click="NewScan_Click"
                                        Style="{StaticResource PrimaryButtonStyle}"
                                        Margin="0,0,4,4"/>
                                <Button x:Name="btnCancelScan" Content="Cancel" 
                                        Click="CancelScan_Click"
                                        Style="{StaticResource ModernButtonStyle}"
                                        IsEnabled="False"
                                        Margin="0,0,4,4"/>
                                <Button x:Name="btnUndoScan" Content="Undo" 
                                        Click="UndoScan_Click"
                                        Style="{StaticResource ModernButtonStyle}"
                                        IsEnabled="False"/>
                            </WrapPanel>
                            
                            <!-- Value Input -->
                            <Grid Margin="0,0,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="txtValue"
                                         Style="{StaticResource ModernTextBoxStyle}"/>
                                <CheckBox x:Name="chkHex" Content="Hex"
                                          Grid.Column="1"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          VerticalAlignment="Center"
                                          FontSize="10"
                                          Margin="6,0,0,0"/>
                            </Grid>

                            <!-- Second Value Input (for "Between" scans) -->
                            <TextBox x:Name="txtValue2"
                                     Style="{StaticResource ModernTextBoxStyle}"
                                     Margin="0,0,0,4"
                                     Visibility="Collapsed"/>
                            
                            <!-- Scan Type & Value Type side by side -->
                            <Grid Margin="0,0,0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="4"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ComboBox x:Name="cmbScanType" Grid.Column="0"
                                          Style="{StaticResource ModernComboBoxStyle}"
                                          SelectionChanged="CmbScanType_SelectionChanged">
                                    <ComboBoxItem Content="Exact value" IsSelected="True"/>
                                    <ComboBoxItem Content="Increased value"/>
                                    <ComboBoxItem Content="Increased value by ..."/>
                                    <ComboBoxItem Content="Decreased value"/>
                                    <ComboBoxItem Content="Decreased value by ..."/>
                                    <ComboBoxItem Content="Value between"/>
                                    <ComboBoxItem Content="Changed value"/>
                                    <ComboBoxItem Content="Unchanged value"/>
                                    <ComboBoxItem Content="Unknown initial value"/>
                                </ComboBox>
                                <ComboBox x:Name="cmbValueType" Grid.Column="2"
                                          Style="{StaticResource ModernComboBoxStyle}">
                                    <ComboBoxItem Content="Byte"/>
                                    <ComboBoxItem Content="2 Bytes"/>
                                    <ComboBoxItem Content="4 Bytes" IsSelected="True"/>
                                    <ComboBoxItem Content="8 Bytes"/>
                                    <ComboBoxItem Content="Float"/>
                                    <ComboBoxItem Content="Double"/>
                                    <ComboBoxItem Content="String"/>
                                    <ComboBoxItem Content="AOB"/>
                                </ComboBox>
                            </Grid>
                            
                            <!-- Checkboxes in compact grid -->
                            <!-- Writable/CopyOnWrite/Executable use 3-state like CheatEngine:
                                 Unchecked = Exclude (don't scan this type)
                                 Checked = Include (ONLY scan this type)
                                 Indeterminate = Don't care (scan both) -->
                            <WrapPanel Margin="0,0,0,4">
                                <CheckBox x:Name="chkWritable" Content="Writable" IsChecked="True"
                                          IsThreeState="True"
                                          ToolTip="Checked: Only scan writable&#x0a;Unchecked: Only scan read-only&#x0a;Indeterminate: Scan both"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          FontSize="10" Margin="0,0,8,0"/>
                                <CheckBox x:Name="chkFastScan" Content="Fast Scan" IsChecked="True"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          FontSize="10" Margin="0,0,8,0"/>
                                <CheckBox x:Name="chkCopyOnWrite" Content="COW"
                                          IsThreeState="True" IsChecked="{x:Null}"
                                          ToolTip="Checked: Only scan copy-on-write&#x0a;Unchecked: Exclude copy-on-write&#x0a;Indeterminate: Scan both"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          FontSize="10" Margin="0,0,8,0"/>
                                <CheckBox x:Name="chkExecutable" Content="Exec"
                                          IsThreeState="True" IsChecked="{x:Null}"
                                          ToolTip="Checked: Only scan executable&#x0a;Unchecked: Exclude executable&#x0a;Indeterminate: Scan both"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          FontSize="10" Margin="0,0,8,0"/>
                                <CheckBox x:Name="chkActiveMemoryOnly" Content="Active Only"
                                          Foreground="{StaticResource TextSecondaryBrush}"
                                          FontSize="10"/>
                            </WrapPanel>
                            
                            <!-- Module Selection -->
                            <ComboBox x:Name="cmbModule"
                                      Style="{StaticResource ModernComboBoxStyle}"
                                      SelectionChanged="CmbModule_SelectionChanged"
                                      Margin="0,0,0,4"/>
                            
                            <!-- Address Range (collapsed by default, expandable) -->
                            <Expander Header="Address Range" IsExpanded="False" Margin="0,0,0,4"
                                      Foreground="{StaticResource TextSecondaryBrush}" FontSize="10">
                                <StackPanel Margin="0,4,0,0">
                                    <Grid Margin="0,0,0,2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Start" FontSize="10" VerticalAlignment="Center"
                                                   Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBox x:Name="txtStartAddress" Grid.Column="1"
                                                 Text="0000000000000000"
                                                 Style="{StaticResource ModernTextBoxStyle}"/>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Stop" FontSize="10" VerticalAlignment="Center"
                                                   Foreground="{StaticResource TextMutedBrush}"/>
                                        <TextBox x:Name="txtStopAddress" Grid.Column="1"
                                                 Text="7FFFFFFFFFFFFFFF"
                                                 Style="{StaticResource ModernTextBoxStyle}"/>
                                    </Grid>
                                </StackPanel>
                            </Expander>
                            
                            <!-- Add Address Manually Button -->
                            <Button Content="âž• Add Address Manually"
                                    Click="AddAddressManually_Click"
                                    Style="{StaticResource ModernButtonStyle}"
                                    HorizontalAlignment="Stretch"
                                    Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Splitter -->
                <GridSplitter Grid.Row="1" 
                              Height="6" 
                              HorizontalAlignment="Stretch"
                              Background="Transparent"
                              Cursor="SizeNS"/>
                
                <!-- BOTTOM SECTION: Address List -->
                <Border Grid.Row="2" Style="{StaticResource CardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" 
                                   Style="{StaticResource SectionHeaderStyle}"
                                   Text="ADDRESS LIST"/>
                        
                        <!-- Address ListView (WPF Native) -->
                        <Border Grid.Row="1"
                                BorderBrush="{StaticResource BorderDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Margin="0,4,0,0">
                            <ListView x:Name="lvAddressListWpf"
                                      Background="#161B22"
                                      Foreground="#E6EDF3"
                                      BorderThickness="0"
                                      SelectionMode="Extended"
                                      MouseDoubleClick="LvAddressList_DoubleClick">
                                <ListView.Resources>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#E6EDF3"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#2D3748"/>
                                                <Setter Property="Foreground" Value="#FFFFFF"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#1F2937"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListView.Resources>
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header=" " Width="50">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding Frozen}"
                                                            Checked="AddressEntry_Checked"
                                                            Unchecked="AddressEntry_Unchecked"
                                                            HorizontalAlignment="Center"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Description" Width="200">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Description}"
                                                             FontFamily="Cascadia Code" FontSize="12"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Address" Width="120">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Address}"
                                                             Foreground="{Binding AddressForeground}"
                                                             FontFamily="Cascadia Code" FontSize="12"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Type" Width="80">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Type}"
                                                             FontFamily="Cascadia Code" FontSize="12"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Value" Width="100">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Value}"
                                                             FontFamily="Cascadia Code" FontSize="12"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                                <ListView.ContextMenu>
                                    <ContextMenu Background="#1F2937" Foreground="#E6EDF3">
                                        <ContextMenu.Resources>
                                            <Style TargetType="MenuItem">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Setter Property="Foreground" Value="#E6EDF3"/>
                                                <Setter Property="BorderThickness" Value="0"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsHighlighted" Value="True">
                                                        <Setter Property="Background" Value="#374151"/>
                                                        <Setter Property="Foreground" Value="#FFFFFF"/>
                                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                                    </Trigger>
                                                    <Trigger Property="IsEnabled" Value="False">
                                                        <Setter Property="Foreground" Value="#6B7280"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                            <Style TargetType="Separator">
                                                <Setter Property="Background" Value="#374151"/>
                                                <Setter Property="Margin" Value="0,2"/>
                                            </Style>
                                        </ContextMenu.Resources>
                                        <MenuItem Header="Toggle Freeze" Click="ToggleFreeze_Click"/>
                                        <MenuItem Header="Show as Hex" Click="ShowAsHex_Click"/>
                                        <Separator/>
                                        <MenuItem Header="Increase Value (+1)" Click="IncreaseValue_Click"/>
                                        <MenuItem Header="Decrease Value (-1)" Click="DecreaseValue_Click"/>
                                        <MenuItem Header="Change Value..." Click="ChangeValue_Click"/>
                                        <Separator/>
                                        <MenuItem Header="Find out what writes to this address" Click="FindWrites_Click"/>
                                        <MenuItem Header="Find out what accesses this address" Click="FindAccesses_Click"/>
                                        <Separator/>
                                        <MenuItem Header="Copy Address" Click="CopyAddress_Click"/>
                                        <MenuItem Header="Copy Value" Click="CopyValue_Click"/>
                                        <MenuItem Header="Copy Description" Click="CopyDescription_Click"/>
                                        <Separator/>
                                        <MenuItem Header="Delete" Click="DeleteAddress_Click"/>
                                    </ContextMenu>
                                </ListView.ContextMenu>
                            </ListView>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- STATUS BAR -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border x:Name="statusBar" Grid.Row="5"
                    Background="{StaticResource BackgroundCardBrush}"
                    Padding="10,5"
                    CornerRadius="0,0,8,8">
                <Grid>
                    <StackPanel x:Name="driverStatusPanel" Orientation="Horizontal" Visibility="Collapsed">
                        <Ellipse Width="6" Height="6" Fill="{StaticResource AccentGreenBrush}"
                                 Margin="0,0,6,0"/>
                        <TextBlock x:Name="txtDriverStatus" Text="Driver: CrxShield Loaded"
                                   Foreground="{StaticResource StatusSuccessBrush}"
                                   FontSize="10"
                                   FontWeight="SemiBold"/>
                    </StackPanel>
                    <TextBlock x:Name="txtStatus"
                               Text="Ready"
                               Foreground="{StaticResource TextMutedBrush}"
                               FontSize="10"
                               HorizontalAlignment="Right"/>

                    <!-- Resize Thumb -->
                    <Thumb x:Name="resizeThumb"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Bottom"
                           Width="16" Height="16"
                           Margin="0,0,-5,-2"
                           Opacity="0.5"
                           Cursor="SizeNWSE"
                           DragDelta="ResizeThumb_DragDelta">
                        <Thumb.Template>
                            <ControlTemplate TargetType="Thumb">
                                <Grid Background="Transparent">
                                    <!-- Visual resize grip indicator -->
                                    <Path Data="M 0,12 L 12,0 M 4,12 L 12,4 M 8,12 L 12,8"
                                          Stroke="#888888"
                                          StrokeThickness="1"
                                          Stretch="None"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Bottom"
                                          Margin="2"/>
                                </Grid>
                            </ControlTemplate>
                        </Thumb.Template>
                    </Thumb>
                </Grid>
            </Border>
            
        </Grid>
    </Border>
    
</Window>
