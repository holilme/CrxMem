<Window x:Class="CrxMem.LuaApiHelpWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CrxMem Lua API Reference"
        Width="700" Height="600"
        MinWidth="500" MinHeight="400"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/Colors.xaml"/>
                <ResourceDictionary Source="Themes/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Selectable code text style using RichTextBox -->
            <Style x:Key="SelectableCodeStyle" TargetType="RichTextBox">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="IsReadOnly" Value="True"/>
                <Setter Property="IsDocumentEnabled" Value="True"/>
                <Setter Property="FontFamily" Value="Cascadia Code, Consolas"/>
                <Setter Property="FontSize" Value="11"/>
                <Setter Property="Foreground" Value="#E6EDF3"/>
                <Setter Property="Padding" Value="0"/>
                <Setter Property="Margin" Value="0"/>
                <Setter Property="IsTabStop" Value="False"/>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <!-- Main Container with Shadow -->
    <Border Background="{StaticResource BackgroundDarkBrush}"
            CornerRadius="8"
            Margin="8"
            BorderBrush="{StaticResource BorderDefaultBrush}"
            BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect BlurRadius="15" ShadowDepth="0" Opacity="0.4" Color="Black"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>      <!-- Custom Title Bar -->
                <RowDefinition Height="Auto"/>    <!-- Search Bar -->
                <RowDefinition Height="*"/>       <!-- Content -->
            </Grid.RowDefinitions>

            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- CUSTOM TITLE BAR -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <Border Grid.Row="0"
                    Background="{StaticResource BackgroundCardBrush}"
                    CornerRadius="8,8,0,0">
                <Grid MouseLeftButtonDown="TitleBar_MouseLeftButtonDown" Background="Transparent">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo & Title -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="10,0" Background="Transparent">
                        <TextBlock Text="?"
                                   Foreground="{StaticResource AccentBlueBrush}"
                                   FontWeight="Bold" FontSize="14"
                                   VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBlock Text="Lua API Reference"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   VerticalAlignment="Center"
                                   FontWeight="SemiBold"
                                   FontSize="12"/>
                    </StackPanel>

                    <!-- Window Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button Content="✕" Click="Close_Click"
                                Style="{StaticResource IconButtonStyle}"
                                Width="40" Height="32" FontSize="10"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- SEARCH BAR -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <Border Grid.Row="1"
                    Background="{StaticResource BackgroundCardBrush}"
                    Padding="12,8"
                    BorderBrush="{StaticResource BorderMutedBrush}"
                    BorderThickness="0,0,0,1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="txtSearch"
                             Style="{StaticResource ModernTextBoxStyle}"
                             TextChanged="TxtSearch_TextChanged"/>
                    <TextBlock x:Name="txtSearchPlaceholder"
                               Text="Search..."
                               Foreground="{StaticResource TextMutedBrush}"
                               VerticalAlignment="Center"
                               Margin="12,0,0,0"
                               IsHitTestVisible="False"/>
                </Grid>
            </Border>

            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- CONTENT AREA -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <ScrollViewer Grid.Row="2"
                          VerticalScrollBarVisibility="Auto"
                          Padding="12">
                <StackPanel x:Name="contentPanel">

                    <!-- MEMORY FUNCTIONS -->
                    <TextBlock Text="MEMORY FUNCTIONS"
                               Style="{StaticResource SectionHeaderStyle}"
                               Margin="0,0,0,8"/>
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Reading Memory" Foreground="{StaticResource AccentBlueBrush}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                                <FlowDocument>
                                    <Paragraph>
                                        <Run Foreground="#58A6FF">readByte</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read 1 byte</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readSmallInteger</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read 2 bytes signed</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readInteger</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read 4 bytes</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readQword</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read 8 bytes</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readFloat</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read float (4 bytes)</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readDouble</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read double (8 bytes)</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readString</Run><Run Foreground="#E6EDF3">(address, maxLen)</Run><Run Foreground="#8B949E"> - Read null-terminated string</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readBytes</Run><Run Foreground="#E6EDF3">(address, count)</Run><Run Foreground="#8B949E"> - Read byte array</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">readPointer</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Read pointer (4/8 bytes)</Run>
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>

                            <TextBlock Text="Writing Memory" Foreground="{StaticResource AccentBlueBrush}" FontWeight="SemiBold" Margin="0,16,0,8"/>
                            <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                                <FlowDocument>
                                    <Paragraph>
                                        <Run Foreground="#58A6FF">writeByte</Run><Run Foreground="#E6EDF3">(address, value)</Run><Run Foreground="#8B949E"> - Write 1 byte</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeSmallInteger</Run><Run Foreground="#E6EDF3">(address, value)</Run><Run Foreground="#8B949E"> - Write 2 bytes</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeInteger</Run><Run Foreground="#E6EDF3">(address, value)</Run><Run Foreground="#8B949E"> - Write 4 bytes</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeQword</Run><Run Foreground="#E6EDF3">(address, value)</Run><Run Foreground="#8B949E"> - Write 8 bytes</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeFloat</Run><Run Foreground="#E6EDF3">(address, value)</Run><Run Foreground="#8B949E"> - Write float</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeDouble</Run><Run Foreground="#E6EDF3">(address, value)</Run><Run Foreground="#8B949E"> - Write double</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeString</Run><Run Foreground="#E6EDF3">(address, text)</Run><Run Foreground="#8B949E"> - Write string</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">writeBytes</Run><Run Foreground="#E6EDF3">(address, {bytes})</Run><Run Foreground="#8B949E"> - Write byte array</Run>
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>

                            <TextBlock Text="Memory Allocation" Foreground="{StaticResource AccentBlueBrush}" FontWeight="SemiBold" Margin="0,16,0,8"/>
                            <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                                <FlowDocument>
                                    <Paragraph>
                                        <Run Foreground="#58A6FF">allocateMemory</Run><Run Foreground="#E6EDF3">(size)</Run><Run Foreground="#8B949E"> - Allocate memory in target process</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">deAlloc</Run><Run Foreground="#E6EDF3">(address)</Run><Run Foreground="#8B949E"> - Free allocated memory</Run>
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>
                        </StackPanel>
                    </Border>

                    <!-- PROCESS FUNCTIONS -->
                    <TextBlock Text="PROCESS FUNCTIONS"
                               Style="{StaticResource SectionHeaderStyle}"
                               Margin="0,0,0,8"/>
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                        <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                            <FlowDocument>
                                <Paragraph>
                                    <Run Foreground="#58A6FF">openProcess</Run><Run Foreground="#E6EDF3">(pidOrName)</Run><Run Foreground="#8B949E"> - Open a process by PID or name</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">getOpenedProcessID</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Get current attached process ID</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">getProcessList</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Get list of running processes</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">getModuleList</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Get loaded modules of attached process</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">getAddress</Run><Run Foreground="#E6EDF3">("module+offset")</Run><Run Foreground="#8B949E"> - Resolve address expression</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">pause</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Suspend target process</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">unpause</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Resume target process</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">targetIs64Bit</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Check if target is 64-bit</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">getProcessIDFromProcessName</Run><Run Foreground="#E6EDF3">(name)</Run><Run Foreground="#8B949E"> - Get PID by name</Run>
                                </Paragraph>
                            </FlowDocument>
                        </RichTextBox>
                    </Border>

                    <!-- SCANNING FUNCTIONS -->
                    <TextBlock Text="SCANNING FUNCTIONS"
                               Style="{StaticResource SectionHeaderStyle}"
                               Margin="0,0,0,8"/>
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                        <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                            <FlowDocument>
                                <Paragraph>
                                    <Run Foreground="#58A6FF">AOBScan</Run><Run Foreground="#E6EDF3">("AA BB ?? CC")</Run><Run Foreground="#8B949E"> - Scan for byte pattern, returns table</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">AOBScanUnique</Run><Run Foreground="#E6EDF3">(pattern)</Run><Run Foreground="#8B949E"> - Scan for unique pattern, returns address or nil</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">AOBScanEx</Run><Run Foreground="#E6EDF3">(pattern, start, stop)</Run><Run Foreground="#8B949E"> - Scan with address range</Run>
                                </Paragraph>
                            </FlowDocument>
                        </RichTextBox>
                    </Border>

                    <!-- UTILITY FUNCTIONS -->
                    <TextBlock Text="UTILITY FUNCTIONS"
                               Style="{StaticResource SectionHeaderStyle}"
                               Margin="0,0,0,8"/>
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                        <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                            <FlowDocument>
                                <Paragraph>
                                    <Run Foreground="#58A6FF">print</Run><Run Foreground="#E6EDF3">(...)</Run><Run Foreground="#8B949E"> - Output text to console</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">showMessage</Run><Run Foreground="#E6EDF3">(text)</Run><Run Foreground="#8B949E"> - Show message box</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">inputQuery</Run><Run Foreground="#E6EDF3">(title, prompt)</Run><Run Foreground="#8B949E"> - Input dialog, returns string</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">sleep</Run><Run Foreground="#E6EDF3">(ms)</Run><Run Foreground="#8B949E"> - Sleep for milliseconds</Run><LineBreak/>
                                    <Run Foreground="#58A6FF">getTickCount</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Get system tick count</Run>
                                </Paragraph>
                            </FlowDocument>
                        </RichTextBox>
                    </Border>

                    <!-- GUI FUNCTIONS -->
                    <TextBlock Text="GUI CREATION"
                               Style="{StaticResource SectionHeaderStyle}"
                               Margin="0,0,0,8"/>
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Form Creation" Foreground="{StaticResource AccentBlueBrush}" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                                <FlowDocument>
                                    <Paragraph>
                                        <Run Foreground="#58A6FF">createForm</Run><Run Foreground="#E6EDF3">()</Run><Run Foreground="#8B949E"> - Create new form window</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  form.Caption = "Title"</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  form.Width = 300</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  form.Height = 200</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  form.show() / form.hide() / form.close()</Run>
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>

                            <TextBlock Text="Controls" Foreground="{StaticResource AccentBlueBrush}" FontWeight="SemiBold" Margin="0,16,0,8"/>
                            <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                                <FlowDocument>
                                    <Paragraph>
                                        <Run Foreground="#58A6FF">createLabel</Run><Run Foreground="#E6EDF3">(form)</Run><Run Foreground="#8B949E"> - Create label</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">createEdit</Run><Run Foreground="#E6EDF3">(form)</Run><Run Foreground="#8B949E"> - Create text input</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">createButton</Run><Run Foreground="#E6EDF3">(form)</Run><Run Foreground="#8B949E"> - Create button</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">createCheckBox</Run><Run Foreground="#E6EDF3">(form)</Run><Run Foreground="#8B949E"> - Create checkbox</Run><LineBreak/>
                                        <Run Foreground="#58A6FF">createTimer</Run><Run Foreground="#E6EDF3">(interval)</Run><Run Foreground="#8B949E"> - Create timer</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  control.Caption = "text"</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  control.Left = x, control.Top = y</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  control.Width = w, control.Height = h</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  control.OnClick = function() ... end</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  checkbox.OnChange = function() ... end</Run><LineBreak/>
                                        <Run Foreground="#8B949E">  checkbox.Checked = true/false</Run>
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>

                            <TextBlock Text="Font Properties" Foreground="{StaticResource AccentBlueBrush}" FontWeight="SemiBold" Margin="0,16,0,8"/>
                            <RichTextBox Style="{StaticResource SelectableCodeStyle}">
                                <FlowDocument>
                                    <Paragraph>
                                        <Run Foreground="#8B949E">control.Font.Size = 12</Run><LineBreak/>
                                        <Run Foreground="#8B949E">control.Font.Color = 0x00FF00</Run><Run Foreground="#6E7681"> -- Green</Run><LineBreak/>
                                        <Run Foreground="#8B949E">control.Font.Style = "fsBold"</Run>
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>
                        </StackPanel>
                    </Border>

                    <!-- EXAMPLE SCRIPT -->
                    <TextBlock Text="EXAMPLE SCRIPT"
                               Style="{StaticResource SectionHeaderStyle}"
                               Margin="0,0,0,8"/>
                    <Border Style="{StaticResource CardStyle}" Background="#0D1117" Margin="0,0,0,16">
                        <RichTextBox Style="{StaticResource SelectableCodeStyle}" Padding="4">
                            <FlowDocument>
                                <Paragraph>
                                    <Run Foreground="#6A9955">-- Simple trainer example</Run><LineBreak/>
                                    <Run Foreground="#569CD6">local </Run><Run Foreground="#E6EDF3">form = createForm()</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">form.Caption = </Run><Run Foreground="#CE9178">"My Trainer"</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">form.Width = </Run><Run Foreground="#B5CEA8">300</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">form.Height = </Run><Run Foreground="#B5CEA8">150</Run><LineBreak/>
                                    <LineBreak/>
                                    <Run Foreground="#569CD6">local </Run><Run Foreground="#E6EDF3">btn = createButton(form)</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">btn.Caption = </Run><Run Foreground="#CE9178">"Max Health"</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">btn.Left = </Run><Run Foreground="#B5CEA8">100</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">btn.Top = </Run><Run Foreground="#B5CEA8">50</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">btn.OnClick = </Run><Run Foreground="#569CD6">function</Run><Run Foreground="#E6EDF3">()</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">    </Run><Run Foreground="#569CD6">local </Run><Run Foreground="#E6EDF3">addr = getAddress(</Run><Run Foreground="#CE9178">"game.exe+0x1234"</Run><Run Foreground="#E6EDF3">)</Run><LineBreak/>
                                    <Run Foreground="#E6EDF3">    writeInteger(addr, </Run><Run Foreground="#B5CEA8">99999</Run><Run Foreground="#E6EDF3">)</Run><LineBreak/>
                                    <Run Foreground="#569CD6">end</Run><LineBreak/>
                                    <LineBreak/>
                                    <Run Foreground="#E6EDF3">form.show()</Run>
                                </Paragraph>
                            </FlowDocument>
                        </RichTextBox>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Border>
</Window>
